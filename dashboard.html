if(window.location.href.indexOf('?code=') != -1) {
  let code = window.location.search.replace('?code=','');
  var xhttp = new XMLHttpRequest();
  xhttp.responseType = 'json';
  xhttp.open("GET", `https://httpsforwarder.ddb08.repl.co/p/api/userinfo/${code}/`);
  xhttp.send();
  xhttp.addEventListener("load", on_response());
  console.log(xhttp.response);
  const json = xhttp.response;
  document.getElementById('Username').innerHTML = json.username;
  document.getElementById('UserImg').src = `https://cdn.discordapp.com/avatars/${json.id}/${json.avatar}?size=28`
}
else {
  //window.location.replace('/login');
}
function on_response () {
  console.log(this.xhttp);
  if(this.xhttp.status != 200 && this.xhttp.status != 0) {
    window.location.replace('/login');
  }
  console.log(this.xhttp.response);
  document.getElementById('Username').innerHTML = this.xhttp.response.username;
  document.getElementById('UserImg').src = `https://cdn.discordapp.com/avatars/${this.xhttp.response.id}/${this.xhttp.response.avatar}?size=28`
}
